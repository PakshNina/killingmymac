# Killing My Mac

Проект для тестирования поведения сборщика мусора и управления памятью в разных версиях Go.

## Описание

Проект содержит две версии программы, которые создают связанный список узлов в памяти для демонстрации работы сборщика мусора Go:

- `initial/main.go` - простая версия, создающая бесконечный связанный список без контроля памяти
- `kill/main.go` - расширенная версия с мониторингом памяти, pprof сервером и автоматической остановкой при превышении лимита памяти

## Структура проекта

```
.
├── Dockerfile19      # Dockerfile для сборки с Go 1.9.7
├── Dockerfile124     # Dockerfile для сборки с Go 1.24.1
├── Makefile          # Команды для сборки и запуска
├── go.mod            # Go модуль
├── initial/          # Простая версия программы
│   └── main.go
└── withstat/             # Версия с мониторингом памяти
    └── main.go
```

## Требования

- Docker
- Make (опционально)

## Использование

### С помощью Make

Показать все доступные команды:

```bash
make help
```

Собрать Docker образ с Go 1.9.7:

```bash
make build19
```

Собрать и запустить контейнер с Go 1.9.7:

```bash
make run19
```

Собрать Docker образ с Go 1.24.1:

```bash
make build124
```

Собрать и запустить контейнер с Go 1.24.1:

```bash
make run124
```

Удалить все Docker образы:

```bash
make clean
```

### Без Make

Собрать образ с Go 1.9.7:

```bash
docker build -t kill-app -f Dockerfile19 .
```

Запустить контейнер с Go 1.9.7:

```bash
docker run --rm -p 8080:8080 kill-app
```

Собрать образ с Go 1.24.1:

```bash
docker build -t normal-app -f Dockerfile124 .
```

Запустить контейнер с Go 1.24.1:

```bash
docker run --rm -p 8080:8080 normal-app
```

## Мониторинг

При запуске версии `kill/main.go` программа:

- Запускает pprof сервер на порту 8080
- Выводит статистику памяти каждые 1000000 созданных узлов
- Останавливается при превышении лимита в 1000MB памяти в куче
- Показывает количество сборок мусора

Для доступа к pprof интерфейсу откройте в браузере:

```
http://localhost:8080/debug/pprof/
```

